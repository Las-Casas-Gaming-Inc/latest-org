{"ast":null,"code":"export default function getFamilyUnits(family) {\n  var familyUnits = [],\n    familyUnitByParent = {},\n    index,\n    len;\n  function FamilySiblings() {\n    this.fromIndex = 0;\n    this.toIndex = 0;\n    this.items = [];\n    this.hash = {};\n  }\n  function FamilyUnit(id) {\n    this.id = id;\n    this.parents = new FamilySiblings();\n    this.children = new FamilySiblings();\n    this.loopSiblings = function (thisArg, itemid, onItem) {\n      this._loop(thisArg, this.parents.hash.hasOwnProperty(itemid) ? this.parents.items : this.children.items, onItem);\n    };\n    this.loopNonSiblings = function (thisArg, itemid, onItem) {\n      this._loop(thisArg, !this.parents.hash.hasOwnProperty(itemid) ? this.parents.items : this.children.items, onItem);\n    };\n    this.loop = function (thisArg, onItem) {\n      this._loop(thisArg, this.parents.items, onItem);\n      this._loop(thisArg, this.children.items, onItem);\n    };\n    this._loop = function (thisArg, items, onItem) {\n      if (onItem != null) {\n        for (var index = 0, len = items.length; index < len; index += 1) {\n          var sibling = items[index];\n          onItem.call(thisArg, sibling);\n        }\n      }\n    };\n    this.addParent = function (itemid) {\n      this._add(itemid, this.parents);\n    };\n    this.addChild = function (itemid) {\n      this._add(itemid, this.children);\n    };\n    this._add = function (itemid, siblings) {\n      if (!siblings.hash.hasOwnProperty(itemid)) {\n        siblings.items.push(itemid);\n        siblings.hash[itemid] = true;\n      }\n    };\n  }\n  index = 0;\n  family.loop(this, function (itemid, item) {\n    var childrenCount = family.countChildren(itemid);\n    if (childrenCount > 0) {\n      if (!familyUnitByParent.hasOwnProperty(itemid)) {\n        var familyUnit = new FamilyUnit(index);\n        index += 1;\n        familyUnit.addParent(itemid);\n        family.loopChildren(this, itemid, function (childid, child) {\n          familyUnit.addChild(childid);\n          if (childrenCount == 1) {\n            family.loopParents(this, childid, function (parentid) {\n              familyUnit.addParent(parentid);\n              familyUnitByParent[parentid] = familyUnit;\n              return family.SKIP;\n            });\n          }\n          return family.SKIP;\n        });\n        familyUnits.push(familyUnit);\n        familyUnitByParent[itemid] = familyUnit;\n      }\n    }\n  });\n  var familyUnitByItemId = {};\n  for (index = 0, len = familyUnits.length; index < len; index += 1) {\n    var familyUnit = familyUnits[index];\n    familyUnit.loop(this, function (itemid) {\n      if (!familyUnitByItemId.hasOwnProperty(itemid)) {\n        familyUnitByItemId[itemid] = [familyUnit];\n      } else {\n        familyUnitByItemId[itemid].push(familyUnit);\n      }\n    });\n  }\n  return familyUnitByItemId;\n}\n;","map":{"version":3,"names":["getFamilyUnits","family","familyUnits","familyUnitByParent","index","len","FamilySiblings","fromIndex","toIndex","items","hash","FamilyUnit","id","parents","children","loopSiblings","thisArg","itemid","onItem","_loop","hasOwnProperty","loopNonSiblings","loop","length","sibling","call","addParent","_add","addChild","siblings","push","item","childrenCount","countChildren","familyUnit","loopChildren","childid","child","loopParents","parentid","SKIP","familyUnitByItemId"],"sources":["/Users/iamnestyyy/ReactProjects/orgchart/node_modules/basicprimitives/src/algorithms/getFamilyUnits.js"],"sourcesContent":["export default function getFamilyUnits(family) {\r\n  var familyUnits = [],\r\n    familyUnitByParent = {},\r\n    index,\r\n    len;\r\n\r\n  function FamilySiblings() {\r\n    this.fromIndex = 0;\r\n    this.toIndex = 0;\r\n    this.items = [];\r\n    this.hash = {};\r\n  }\r\n\r\n  function FamilyUnit(id) {\r\n    this.id = id;\r\n    this.parents = new FamilySiblings();\r\n    this.children = new FamilySiblings();\r\n\r\n    this.loopSiblings = function (thisArg, itemid, onItem) {\r\n      this._loop(thisArg, this.parents.hash.hasOwnProperty(itemid) ? this.parents.items : this.children.items, onItem);\r\n    };\r\n\r\n    this.loopNonSiblings = function (thisArg, itemid, onItem) {\r\n      this._loop(thisArg, !this.parents.hash.hasOwnProperty(itemid) ? this.parents.items : this.children.items, onItem);\r\n    };\r\n\r\n    this.loop = function (thisArg, onItem) {\r\n      this._loop(thisArg, this.parents.items, onItem);\r\n      this._loop(thisArg, this.children.items, onItem);\r\n    };\r\n\r\n    this._loop = function (thisArg, items, onItem) {\r\n      if (onItem != null) {\r\n        for (var index = 0, len = items.length; index < len; index += 1) {\r\n          var sibling = items[index];\r\n          onItem.call(thisArg, sibling);\r\n        }\r\n      }\r\n    };\r\n\r\n    this.addParent = function (itemid) {\r\n      this._add(itemid, this.parents);\r\n    };\r\n\r\n    this.addChild = function (itemid) {\r\n      this._add(itemid, this.children);\r\n    };\r\n\r\n    this._add = function (itemid, siblings) {\r\n      if (!siblings.hash.hasOwnProperty(itemid)) {\r\n        siblings.items.push(itemid);\r\n        siblings.hash[itemid] = true;\r\n      }\r\n    };\r\n  }\r\n\r\n  index = 0;\r\n  family.loop(this, function (itemid, item) {\r\n    var childrenCount = family.countChildren(itemid);\r\n    if (childrenCount > 0) {\r\n      if (!familyUnitByParent.hasOwnProperty(itemid)) {\r\n        var familyUnit = new FamilyUnit(index);\r\n        index += 1;\r\n        familyUnit.addParent(itemid);\r\n        family.loopChildren(this, itemid, function (childid, child) {\r\n          familyUnit.addChild(childid);\r\n          if (childrenCount == 1) {\r\n            family.loopParents(this, childid, function (parentid) {\r\n              familyUnit.addParent(parentid);\r\n              familyUnitByParent[parentid] = familyUnit;\r\n              return family.SKIP;\r\n            });\r\n          }\r\n          return family.SKIP;\r\n        });\r\n        familyUnits.push(familyUnit);\r\n        familyUnitByParent[itemid] = familyUnit;\r\n      }\r\n    }\r\n  });\r\n\r\n  var familyUnitByItemId = {};\r\n  for (index = 0, len = familyUnits.length; index < len; index += 1) {\r\n    var familyUnit = familyUnits[index];\r\n    familyUnit.loop(this, function (itemid) {\r\n      if (!familyUnitByItemId.hasOwnProperty(itemid)) {\r\n        familyUnitByItemId[itemid] = [familyUnit];\r\n      } else {\r\n        familyUnitByItemId[itemid].push(familyUnit);\r\n      }\r\n    });\r\n  }\r\n\r\n  return familyUnitByItemId;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}