{"ast":null,"code":"import Rect from '../../graphics/structs/Rect';\nimport { Layers, Visibility, Colors, ShapeType, LineType } from '../../enums';\nimport PolylinesBuffer from '../../graphics/structs/PolylinesBuffer';\nimport DotSegment from '../../graphics/structs/DotSegment';\nimport PaletteItem from '../../graphics/structs/PaletteItem';\nimport Marker from '../../graphics/shapes/Marker';\nexport default function DrawMinimizedItemsTask(getGraphics, createTransformTask, applyLayoutChangesTask, minimizedItemsOptionTask, itemTemplateParamsTask, alignDiagramTask) {\n  var _graphics,\n    _transform,\n    _debug = false,\n    _options,\n    _positions;\n  function process() {\n    _graphics = getGraphics();\n    _transform = createTransformTask.getTransform();\n    _options = minimizedItemsOptionTask.getOptions();\n    _positions = alignDiagramTask.getItemsPositions();\n    _graphics.reset(\"placeholder\", Layers.Marker);\n    drawMinimizedItems();\n    return false;\n  }\n  function drawMinimizedItems() {\n    var markers = new PolylinesBuffer(),\n      paletteItems = {},\n      polyline,\n      marker = new Marker(),\n      itemTitleColor,\n      itemFillColor,\n      minimizedItemShapeType,\n      minimizedItemCornerRadius,\n      treeItemPosition,\n      actualPosition,\n      minimizedItemsOptions,\n      templateParams,\n      templateConfig;\n    for (var treeItemId in _positions) {\n      if (_positions.hasOwnProperty(treeItemId)) {\n        treeItemPosition = _positions[treeItemId], actualPosition = treeItemPosition.actualPosition, minimizedItemsOptions = minimizedItemsOptionTask.getItemOptions(treeItemId);\n        _transform.transformRect(actualPosition.x, actualPosition.y, actualPosition.width, actualPosition.height, true, this, function (x, y, width, height) {\n          switch (treeItemPosition.actualVisibility) {\n            case Visibility.Dot:\n              templateParams = itemTemplateParamsTask.getTemplateParams(treeItemId);\n              templateConfig = templateParams.template.templateConfig;\n              itemTitleColor = null;\n              itemFillColor = null;\n              minimizedItemShapeType = null;\n              minimizedItemCornerRadius = 0;\n\n              /* use individual item options first */\n              if (minimizedItemsOptions != null) {\n                itemTitleColor = minimizedItemsOptions.itemTitleColor;\n                itemFillColor = minimizedItemsOptions.itemTitleColor;\n                minimizedItemShapeType = minimizedItemsOptions.minimizedItemShapeType;\n              }\n\n              /* use template config & control options next */\n              itemTitleColor = itemTitleColor || templateConfig.minimizedItemBorderColor || Colors.Navy;\n              itemFillColor = itemFillColor || templateConfig.minimizedItemFillColor || Colors.Navy;\n              if (minimizedItemShapeType == null) {\n                minimizedItemShapeType = templateConfig.minimizedItemShapeType !== null ? templateConfig.minimizedItemShapeType : _options.minimizedItemShapeType;\n              }\n              minimizedItemCornerRadius = templateConfig.minimizedItemCornerRadius === null ? templateConfig.minimizedItemSize.width : templateConfig.minimizedItemCornerRadius;\n              if (minimizedItemShapeType == null || minimizedItemShapeType == ShapeType.None) {\n                polyline = markers.getPolyline(new PaletteItem({\n                  'lineColor': itemTitleColor,\n                  'lineWidth': templateConfig.minimizedItemLineWidth,\n                  'lineType': templateConfig.minimizedItemLineType,\n                  'fillColor': itemFillColor,\n                  'opacity': templateConfig.minimizedItemOpacity\n                }));\n                polyline.addSegment(new DotSegment(x, y, width, height, minimizedItemCornerRadius));\n              } else {\n                marker.draw(markers, minimizedItemShapeType, new Rect(x, y, width, height), new PaletteItem({\n                  'lineColor': itemTitleColor,\n                  'lineWidth': templateConfig.minimizedItemLineWidth,\n                  'lineType': templateConfig.minimizedItemLineType,\n                  'fillColor': itemFillColor,\n                  'opacity': templateConfig.minimizedItemOpacity\n                }));\n              }\n              break;\n            case Visibility.Invisible:\n              if (_debug) {\n                itemTitleColor = Colors.Red;\n                if (!paletteItems.hasOwnProperty(itemTitleColor)) {\n                  paletteItems[itemTitleColor] = new PaletteItem({\n                    'lineColor': itemTitleColor,\n                    'lineWidth': 1,\n                    'lineType': LineType.Solid,\n                    'fillColor': itemTitleColor,\n                    'opacity': 1\n                  });\n                }\n                polyline = markers.getPolyline(paletteItems[itemTitleColor]);\n                polyline.addSegment(new DotSegment(x - 4, y - 4, 8, 8, 4));\n              }\n              break;\n            default:\n              break;\n          }\n        }); //ignore jslint\n      }\n    }\n    _graphics.activate(\"placeholder\", Layers.Marker);\n    _graphics.polylinesBuffer(markers);\n  }\n  return {\n    process: process\n  };\n}\n;","map":{"version":3,"names":["Rect","Layers","Visibility","Colors","ShapeType","LineType","PolylinesBuffer","DotSegment","PaletteItem","Marker","DrawMinimizedItemsTask","getGraphics","createTransformTask","applyLayoutChangesTask","minimizedItemsOptionTask","itemTemplateParamsTask","alignDiagramTask","_graphics","_transform","_debug","_options","_positions","process","getTransform","getOptions","getItemsPositions","reset","drawMinimizedItems","markers","paletteItems","polyline","marker","itemTitleColor","itemFillColor","minimizedItemShapeType","minimizedItemCornerRadius","treeItemPosition","actualPosition","minimizedItemsOptions","templateParams","templateConfig","treeItemId","hasOwnProperty","getItemOptions","transformRect","x","y","width","height","actualVisibility","Dot","getTemplateParams","template","minimizedItemBorderColor","Navy","minimizedItemFillColor","minimizedItemSize","None","getPolyline","minimizedItemLineWidth","minimizedItemLineType","minimizedItemOpacity","addSegment","draw","Invisible","Red","Solid","activate","polylinesBuffer"],"sources":["C:/Users/LCGI_15/Desktop/projects/nesty-orgchart/orgchart/node_modules/basicprimitives/src/tasks/renders/DrawMinimizedItemsTask.js"],"sourcesContent":["import Rect from '../../graphics/structs/Rect';\r\nimport { Layers, Visibility, Colors, ShapeType, LineType } from '../../enums';\r\nimport PolylinesBuffer from '../../graphics/structs/PolylinesBuffer';\r\nimport DotSegment from '../../graphics/structs/DotSegment';\r\nimport PaletteItem from '../../graphics/structs/PaletteItem';\r\nimport Marker from '../../graphics/shapes/Marker';\r\n\r\nexport default function DrawMinimizedItemsTask(getGraphics, createTransformTask, applyLayoutChangesTask,\r\n  minimizedItemsOptionTask, itemTemplateParamsTask, alignDiagramTask) {\r\n  var _graphics,\r\n    _transform,\r\n    _debug = false,\r\n    _options,\r\n    _positions;\r\n\r\n  function process() {\r\n\r\n    _graphics = getGraphics();\r\n\r\n    _transform = createTransformTask.getTransform();\r\n    _options = minimizedItemsOptionTask.getOptions();\r\n    _positions = alignDiagramTask.getItemsPositions();\r\n\r\n    _graphics.reset(\"placeholder\", Layers.Marker);\r\n\r\n    drawMinimizedItems();\r\n\r\n    return false;\r\n  }\r\n\r\n  function drawMinimizedItems() {\r\n    var markers = new PolylinesBuffer(),\r\n      paletteItems = {},\r\n      polyline,\r\n      marker = new Marker(),\r\n      itemTitleColor,\r\n      itemFillColor,\r\n      minimizedItemShapeType,\r\n      minimizedItemCornerRadius,\r\n      treeItemPosition,\r\n      actualPosition,\r\n      minimizedItemsOptions,\r\n      templateParams,\r\n      templateConfig;\r\n\r\n    for (var treeItemId in _positions) {\r\n      if (_positions.hasOwnProperty(treeItemId)) {\r\n        treeItemPosition = _positions[treeItemId],\r\n          actualPosition = treeItemPosition.actualPosition,\r\n          minimizedItemsOptions = minimizedItemsOptionTask.getItemOptions(treeItemId);\r\n\r\n        _transform.transformRect(actualPosition.x, actualPosition.y, actualPosition.width, actualPosition.height, true,\r\n          this, function (x, y, width, height) {\r\n            switch (treeItemPosition.actualVisibility) {\r\n              case Visibility.Dot:\r\n                templateParams = itemTemplateParamsTask.getTemplateParams(treeItemId);\r\n                templateConfig = templateParams.template.templateConfig;\r\n\r\n                itemTitleColor = null;\r\n                itemFillColor = null;\r\n                minimizedItemShapeType = null;\r\n                minimizedItemCornerRadius = 0;\r\n\r\n                /* use individual item options first */\r\n                if (minimizedItemsOptions != null) {\r\n                  itemTitleColor = minimizedItemsOptions.itemTitleColor;\r\n                  itemFillColor = minimizedItemsOptions.itemTitleColor;\r\n                  minimizedItemShapeType = minimizedItemsOptions.minimizedItemShapeType;\r\n                }\r\n\r\n                /* use template config & control options next */\r\n                itemTitleColor = itemTitleColor || templateConfig.minimizedItemBorderColor || Colors.Navy;\r\n                itemFillColor = itemFillColor || templateConfig.minimizedItemFillColor || Colors.Navy;\r\n                if (minimizedItemShapeType == null) {\r\n                  minimizedItemShapeType = (templateConfig.minimizedItemShapeType !== null ? templateConfig.minimizedItemShapeType : _options.minimizedItemShapeType);\r\n                }\r\n                minimizedItemCornerRadius = templateConfig.minimizedItemCornerRadius === null ? templateConfig.minimizedItemSize.width : templateConfig.minimizedItemCornerRadius;\r\n\r\n                if (minimizedItemShapeType == null || minimizedItemShapeType == ShapeType.None) {\r\n                  polyline = markers.getPolyline(new PaletteItem({\r\n                    'lineColor': itemTitleColor,\r\n                    'lineWidth': templateConfig.minimizedItemLineWidth,\r\n                    'lineType': templateConfig.minimizedItemLineType,\r\n                    'fillColor': itemFillColor,\r\n                    'opacity': templateConfig.minimizedItemOpacity\r\n                  }));\r\n                  polyline.addSegment(new DotSegment(x, y, width, height, minimizedItemCornerRadius));\r\n                } else {\r\n                  marker.draw(markers, minimizedItemShapeType, new Rect(x, y, width, height),\r\n                    new PaletteItem({\r\n                      'lineColor': itemTitleColor,\r\n                      'lineWidth': templateConfig.minimizedItemLineWidth,\r\n                      'lineType': templateConfig.minimizedItemLineType,\r\n                      'fillColor': itemFillColor,\r\n                      'opacity': templateConfig.minimizedItemOpacity\r\n                    })\r\n                  );\r\n                }\r\n                break;\r\n              case Visibility.Invisible:\r\n                if (_debug) {\r\n                  itemTitleColor = Colors.Red;\r\n                  if (!paletteItems.hasOwnProperty(itemTitleColor)) {\r\n                    paletteItems[itemTitleColor] = new PaletteItem({\r\n                      'lineColor': itemTitleColor,\r\n                      'lineWidth': 1,\r\n                      'lineType': LineType.Solid,\r\n                      'fillColor': itemTitleColor,\r\n                      'opacity': 1\r\n                    });\r\n                  }\r\n                  polyline = markers.getPolyline(paletteItems[itemTitleColor]);\r\n                  polyline.addSegment(new DotSegment(x - 4, y - 4, 8, 8, 4));\r\n                }\r\n                break;                \r\n              default:\r\n                break;\r\n            }\r\n          });//ignore jslint\r\n      }\r\n    }\r\n\r\n\r\n    _graphics.activate(\"placeholder\", Layers.Marker);\r\n    _graphics.polylinesBuffer(markers);\r\n  }\r\n\r\n  return {\r\n    process: process\r\n  };\r\n};\r\n"],"mappings":"AAAA,OAAOA,IAAI,MAAM,6BAA6B;AAC9C,SAASC,MAAM,EAAEC,UAAU,EAAEC,MAAM,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,aAAa;AAC7E,OAAOC,eAAe,MAAM,wCAAwC;AACpE,OAAOC,UAAU,MAAM,mCAAmC;AAC1D,OAAOC,WAAW,MAAM,oCAAoC;AAC5D,OAAOC,MAAM,MAAM,8BAA8B;AAEjD,eAAe,SAASC,sBAAsBA,CAACC,WAAW,EAAEC,mBAAmB,EAAEC,sBAAsB,EACrGC,wBAAwB,EAAEC,sBAAsB,EAAEC,gBAAgB,EAAE;EACpE,IAAIC,SAAS;IACXC,UAAU;IACVC,MAAM,GAAG,KAAK;IACdC,QAAQ;IACRC,UAAU;EAEZ,SAASC,OAAOA,CAAA,EAAG;IAEjBL,SAAS,GAAGN,WAAW,CAAC,CAAC;IAEzBO,UAAU,GAAGN,mBAAmB,CAACW,YAAY,CAAC,CAAC;IAC/CH,QAAQ,GAAGN,wBAAwB,CAACU,UAAU,CAAC,CAAC;IAChDH,UAAU,GAAGL,gBAAgB,CAACS,iBAAiB,CAAC,CAAC;IAEjDR,SAAS,CAACS,KAAK,CAAC,aAAa,EAAEzB,MAAM,CAACQ,MAAM,CAAC;IAE7CkB,kBAAkB,CAAC,CAAC;IAEpB,OAAO,KAAK;EACd;EAEA,SAASA,kBAAkBA,CAAA,EAAG;IAC5B,IAAIC,OAAO,GAAG,IAAItB,eAAe,CAAC,CAAC;MACjCuB,YAAY,GAAG,CAAC,CAAC;MACjBC,QAAQ;MACRC,MAAM,GAAG,IAAItB,MAAM,CAAC,CAAC;MACrBuB,cAAc;MACdC,aAAa;MACbC,sBAAsB;MACtBC,yBAAyB;MACzBC,gBAAgB;MAChBC,cAAc;MACdC,qBAAqB;MACrBC,cAAc;MACdC,cAAc;IAEhB,KAAK,IAAIC,UAAU,IAAIpB,UAAU,EAAE;MACjC,IAAIA,UAAU,CAACqB,cAAc,CAACD,UAAU,CAAC,EAAE;QACzCL,gBAAgB,GAAGf,UAAU,CAACoB,UAAU,CAAC,EACvCJ,cAAc,GAAGD,gBAAgB,CAACC,cAAc,EAChDC,qBAAqB,GAAGxB,wBAAwB,CAAC6B,cAAc,CAACF,UAAU,CAAC;QAE7EvB,UAAU,CAAC0B,aAAa,CAACP,cAAc,CAACQ,CAAC,EAAER,cAAc,CAACS,CAAC,EAAET,cAAc,CAACU,KAAK,EAAEV,cAAc,CAACW,MAAM,EAAE,IAAI,EAC5G,IAAI,EAAE,UAAUH,CAAC,EAAEC,CAAC,EAAEC,KAAK,EAAEC,MAAM,EAAE;UACnC,QAAQZ,gBAAgB,CAACa,gBAAgB;YACvC,KAAK/C,UAAU,CAACgD,GAAG;cACjBX,cAAc,GAAGxB,sBAAsB,CAACoC,iBAAiB,CAACV,UAAU,CAAC;cACrED,cAAc,GAAGD,cAAc,CAACa,QAAQ,CAACZ,cAAc;cAEvDR,cAAc,GAAG,IAAI;cACrBC,aAAa,GAAG,IAAI;cACpBC,sBAAsB,GAAG,IAAI;cAC7BC,yBAAyB,GAAG,CAAC;;cAE7B;cACA,IAAIG,qBAAqB,IAAI,IAAI,EAAE;gBACjCN,cAAc,GAAGM,qBAAqB,CAACN,cAAc;gBACrDC,aAAa,GAAGK,qBAAqB,CAACN,cAAc;gBACpDE,sBAAsB,GAAGI,qBAAqB,CAACJ,sBAAsB;cACvE;;cAEA;cACAF,cAAc,GAAGA,cAAc,IAAIQ,cAAc,CAACa,wBAAwB,IAAIlD,MAAM,CAACmD,IAAI;cACzFrB,aAAa,GAAGA,aAAa,IAAIO,cAAc,CAACe,sBAAsB,IAAIpD,MAAM,CAACmD,IAAI;cACrF,IAAIpB,sBAAsB,IAAI,IAAI,EAAE;gBAClCA,sBAAsB,GAAIM,cAAc,CAACN,sBAAsB,KAAK,IAAI,GAAGM,cAAc,CAACN,sBAAsB,GAAGd,QAAQ,CAACc,sBAAuB;cACrJ;cACAC,yBAAyB,GAAGK,cAAc,CAACL,yBAAyB,KAAK,IAAI,GAAGK,cAAc,CAACgB,iBAAiB,CAACT,KAAK,GAAGP,cAAc,CAACL,yBAAyB;cAEjK,IAAID,sBAAsB,IAAI,IAAI,IAAIA,sBAAsB,IAAI9B,SAAS,CAACqD,IAAI,EAAE;gBAC9E3B,QAAQ,GAAGF,OAAO,CAAC8B,WAAW,CAAC,IAAIlD,WAAW,CAAC;kBAC7C,WAAW,EAAEwB,cAAc;kBAC3B,WAAW,EAAEQ,cAAc,CAACmB,sBAAsB;kBAClD,UAAU,EAAEnB,cAAc,CAACoB,qBAAqB;kBAChD,WAAW,EAAE3B,aAAa;kBAC1B,SAAS,EAAEO,cAAc,CAACqB;gBAC5B,CAAC,CAAC,CAAC;gBACH/B,QAAQ,CAACgC,UAAU,CAAC,IAAIvD,UAAU,CAACsC,CAAC,EAAEC,CAAC,EAAEC,KAAK,EAAEC,MAAM,EAAEb,yBAAyB,CAAC,CAAC;cACrF,CAAC,MAAM;gBACLJ,MAAM,CAACgC,IAAI,CAACnC,OAAO,EAAEM,sBAAsB,EAAE,IAAIlC,IAAI,CAAC6C,CAAC,EAAEC,CAAC,EAAEC,KAAK,EAAEC,MAAM,CAAC,EACxE,IAAIxC,WAAW,CAAC;kBACd,WAAW,EAAEwB,cAAc;kBAC3B,WAAW,EAAEQ,cAAc,CAACmB,sBAAsB;kBAClD,UAAU,EAAEnB,cAAc,CAACoB,qBAAqB;kBAChD,WAAW,EAAE3B,aAAa;kBAC1B,SAAS,EAAEO,cAAc,CAACqB;gBAC5B,CAAC,CACH,CAAC;cACH;cACA;YACF,KAAK3D,UAAU,CAAC8D,SAAS;cACvB,IAAI7C,MAAM,EAAE;gBACVa,cAAc,GAAG7B,MAAM,CAAC8D,GAAG;gBAC3B,IAAI,CAACpC,YAAY,CAACa,cAAc,CAACV,cAAc,CAAC,EAAE;kBAChDH,YAAY,CAACG,cAAc,CAAC,GAAG,IAAIxB,WAAW,CAAC;oBAC7C,WAAW,EAAEwB,cAAc;oBAC3B,WAAW,EAAE,CAAC;oBACd,UAAU,EAAE3B,QAAQ,CAAC6D,KAAK;oBAC1B,WAAW,EAAElC,cAAc;oBAC3B,SAAS,EAAE;kBACb,CAAC,CAAC;gBACJ;gBACAF,QAAQ,GAAGF,OAAO,CAAC8B,WAAW,CAAC7B,YAAY,CAACG,cAAc,CAAC,CAAC;gBAC5DF,QAAQ,CAACgC,UAAU,CAAC,IAAIvD,UAAU,CAACsC,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;cAC5D;cACA;YACF;cACE;UACJ;QACF,CAAC,CAAC,CAAC;MACP;IACF;IAGA7B,SAAS,CAACkD,QAAQ,CAAC,aAAa,EAAElE,MAAM,CAACQ,MAAM,CAAC;IAChDQ,SAAS,CAACmD,eAAe,CAACxC,OAAO,CAAC;EACpC;EAEA,OAAO;IACLN,OAAO,EAAEA;EACX,CAAC;AACH;AAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}