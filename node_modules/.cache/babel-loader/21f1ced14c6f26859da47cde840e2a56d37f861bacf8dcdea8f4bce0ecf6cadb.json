{"ast":null,"code":"import FamilyItem from '../../models/FamilyItem';\nimport { GroupByType } from '../../enums';\nexport default function BindFamilyConnectorsTask(hideGrandParentsConnectorsTask) {\n  var _data = {\n    maximumId: null,\n    /* maximum of OrgItem.id */\n    logicalFamily: null\n  };\n  function process(debug) {\n    var logicalFamily = hideGrandParentsConnectorsTask.getLogicalFamily(),\n      maximumId = hideGrandParentsConnectorsTask.getMaximumId();\n    logicalFamily = logicalFamily.clone();\n\n    /* Optimize family references. Bundle connectors where it is possible */\n    logicalFamily.optimizeReferences(function () {\n      maximumId += 1;\n      return new FamilyItem({\n        id: maximumId,\n        isVisible: false,\n        isActive: false,\n        itemConfig: {\n          title: \"bundle #\" + maximumId,\n          description: \" This item was created by references optimizer.\"\n        },\n        levelGravity: GroupByType.Children,\n        isLevelNeutral: true\n      });\n    }); //ignore jslint\n\n    if (debug && !logicalFamily.validate()) {\n      throw \"References are broken in family structure!\";\n    }\n    if (debug && logicalFamily.hasLoops()) {\n      throw \"Structure has loops!\";\n    }\n\n    /* eliminate many to many connections in chart, every connection should be ether child or parent relation. */\n    logicalFamily.eliminateManyToMany(function () {\n      maximumId += 1;\n      return new FamilyItem({\n        id: maximumId,\n        isVisible: false,\n        isActive: false,\n        itemConfig: {\n          title: \"dummy #\" + maximumId,\n          description: \"This is item used to eliminate M:M relations.\"\n        },\n        levelGravity: GroupByType.Children,\n        hideParentConnection: false,\n        hideChildrenConnection: false,\n        isLevelNeutral: true\n      });\n    } //ignore jslint\n    );\n    if (debug && !logicalFamily.validate()) {\n      throw \"References are broken in family structure!\";\n    }\n    _data.logicalFamily = logicalFamily;\n    _data.maximumId = maximumId;\n    return true;\n  }\n  function getLogicalFamily() {\n    return _data.logicalFamily;\n  }\n  function getMaximumId() {\n    return _data.maximumId;\n  }\n  return {\n    process: process,\n    getLogicalFamily: getLogicalFamily,\n    getMaximumId: getMaximumId\n  };\n}\n;","map":{"version":3,"names":["FamilyItem","GroupByType","BindFamilyConnectorsTask","hideGrandParentsConnectorsTask","_data","maximumId","logicalFamily","process","debug","getLogicalFamily","getMaximumId","clone","optimizeReferences","id","isVisible","isActive","itemConfig","title","description","levelGravity","Children","isLevelNeutral","validate","hasLoops","eliminateManyToMany","hideParentConnection","hideChildrenConnection"],"sources":["/Users/iamnestyyy/ReactProjects/orgchart/node_modules/basicprimitives/src/tasks/transformations/BindFamilyConnectorsTask.js"],"sourcesContent":["import FamilyItem from '../../models/FamilyItem';\r\nimport { GroupByType } from '../../enums';\r\n\r\nexport default function BindFamilyConnectorsTask(hideGrandParentsConnectorsTask) {\r\n  var _data = {\r\n    maximumId: null, /* maximum of OrgItem.id */\r\n    logicalFamily: null\r\n  };\r\n\r\n  function process(debug) {\r\n    var logicalFamily = hideGrandParentsConnectorsTask.getLogicalFamily(),\r\n      maximumId = hideGrandParentsConnectorsTask.getMaximumId();\r\n\r\n    logicalFamily = logicalFamily.clone();\r\n\r\n    /* Optimize family references. Bundle connectors where it is possible */\r\n    logicalFamily.optimizeReferences(function () {\r\n      maximumId += 1;\r\n\r\n      return new FamilyItem({\r\n        id: maximumId,\r\n        isVisible: false,\r\n        isActive: false,\r\n        itemConfig: { title: \"bundle #\" + maximumId, description: \" This item was created by references optimizer.\" },\r\n        levelGravity: GroupByType.Children,\r\n        isLevelNeutral: true\r\n      });\r\n    }); //ignore jslint\r\n\r\n    if (debug && !logicalFamily.validate()) {\r\n      throw \"References are broken in family structure!\";\r\n    }\r\n    if (debug && logicalFamily.hasLoops()) {\r\n      throw \"Structure has loops!\";\r\n    }\r\n\r\n    /* eliminate many to many connections in chart, every connection should be ether child or parent relation. */\r\n    logicalFamily.eliminateManyToMany(function () {\r\n      maximumId += 1;\r\n\r\n      return new FamilyItem({\r\n        id: maximumId,\r\n        isVisible: false,\r\n        isActive: false,\r\n        itemConfig: { title: \"dummy #\" + maximumId, description: \"This is item used to eliminate M:M relations.\" },\r\n        levelGravity: GroupByType.Children,\r\n        hideParentConnection: false,\r\n        hideChildrenConnection: false,\r\n        isLevelNeutral: true\r\n      });\r\n    } //ignore jslint\r\n    );\r\n\r\n    if (debug && !logicalFamily.validate()) {\r\n      throw \"References are broken in family structure!\";\r\n    }\r\n\r\n    _data.logicalFamily = logicalFamily;\r\n    _data.maximumId = maximumId;\r\n\r\n    return true;\r\n  }\r\n\r\n  function getLogicalFamily() {\r\n    return _data.logicalFamily;\r\n  }\r\n\r\n  function getMaximumId() {\r\n    return _data.maximumId;\r\n  }\r\n\r\n  return {\r\n    process: process,\r\n    getLogicalFamily: getLogicalFamily,\r\n    getMaximumId: getMaximumId\r\n  };\r\n};\r\n"],"mappings":"AAAA,OAAOA,UAAU,MAAM,yBAAyB;AAChD,SAASC,WAAW,QAAQ,aAAa;AAEzC,eAAe,SAASC,wBAAwBA,CAACC,8BAA8B,EAAE;EAC/E,IAAIC,KAAK,GAAG;IACVC,SAAS,EAAE,IAAI;IAAE;IACjBC,aAAa,EAAE;EACjB,CAAC;EAED,SAASC,OAAOA,CAACC,KAAK,EAAE;IACtB,IAAIF,aAAa,GAAGH,8BAA8B,CAACM,gBAAgB,CAAC,CAAC;MACnEJ,SAAS,GAAGF,8BAA8B,CAACO,YAAY,CAAC,CAAC;IAE3DJ,aAAa,GAAGA,aAAa,CAACK,KAAK,CAAC,CAAC;;IAErC;IACAL,aAAa,CAACM,kBAAkB,CAAC,YAAY;MAC3CP,SAAS,IAAI,CAAC;MAEd,OAAO,IAAIL,UAAU,CAAC;QACpBa,EAAE,EAAER,SAAS;QACbS,SAAS,EAAE,KAAK;QAChBC,QAAQ,EAAE,KAAK;QACfC,UAAU,EAAE;UAAEC,KAAK,EAAE,UAAU,GAAGZ,SAAS;UAAEa,WAAW,EAAE;QAAkD,CAAC;QAC7GC,YAAY,EAAElB,WAAW,CAACmB,QAAQ;QAClCC,cAAc,EAAE;MAClB,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC,CAAC;;IAEJ,IAAIb,KAAK,IAAI,CAACF,aAAa,CAACgB,QAAQ,CAAC,CAAC,EAAE;MACtC,MAAM,4CAA4C;IACpD;IACA,IAAId,KAAK,IAAIF,aAAa,CAACiB,QAAQ,CAAC,CAAC,EAAE;MACrC,MAAM,sBAAsB;IAC9B;;IAEA;IACAjB,aAAa,CAACkB,mBAAmB,CAAC,YAAY;MAC5CnB,SAAS,IAAI,CAAC;MAEd,OAAO,IAAIL,UAAU,CAAC;QACpBa,EAAE,EAAER,SAAS;QACbS,SAAS,EAAE,KAAK;QAChBC,QAAQ,EAAE,KAAK;QACfC,UAAU,EAAE;UAAEC,KAAK,EAAE,SAAS,GAAGZ,SAAS;UAAEa,WAAW,EAAE;QAAgD,CAAC;QAC1GC,YAAY,EAAElB,WAAW,CAACmB,QAAQ;QAClCK,oBAAoB,EAAE,KAAK;QAC3BC,sBAAsB,EAAE,KAAK;QAC7BL,cAAc,EAAE;MAClB,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,CAAC;IAED,IAAIb,KAAK,IAAI,CAACF,aAAa,CAACgB,QAAQ,CAAC,CAAC,EAAE;MACtC,MAAM,4CAA4C;IACpD;IAEAlB,KAAK,CAACE,aAAa,GAAGA,aAAa;IACnCF,KAAK,CAACC,SAAS,GAAGA,SAAS;IAE3B,OAAO,IAAI;EACb;EAEA,SAASI,gBAAgBA,CAAA,EAAG;IAC1B,OAAOL,KAAK,CAACE,aAAa;EAC5B;EAEA,SAASI,YAAYA,CAAA,EAAG;IACtB,OAAON,KAAK,CAACC,SAAS;EACxB;EAEA,OAAO;IACLE,OAAO,EAAEA,OAAO;IAChBE,gBAAgB,EAAEA,gBAAgB;IAClCC,YAAY,EAAEA;EAChB,CAAC;AACH;AAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}