{"ast":null,"code":"import Tree from '../../algorithms/Tree';\nimport OrgItem from '../../models/OrgItem';\nimport OrgItemConfig from '../../configs/OrgItemConfig';\nimport { ItemType, ChildrenPlacementType } from '../../enums';\nexport default function OrgTreeTask(itemsOptionTask) {\n  var _data = {\n    orgTree: null,\n    /*Tree OrgItem */\n    maximumId: null /* maximum of OrgItem.id */\n  };\n  function process() {\n    createOrgTree(itemsOptionTask.getItems());\n    return true;\n  }\n  function createOrgTree(items) {\n    var orgItem,\n      orgItemRoot,\n      userItem,\n      index,\n      len,\n      maximumId = 0,\n      parsedId,\n      // Organizational chart definition \n      orgTree = Tree(),\n      rootItemConfig;\n\n    /* convert items to hash table */\n    for (index = 0, len = items.length; index < len; index += 1) {\n      userItem = items[index];\n      /* user should define unique id for every OrgItemConfig otherwise we ignore it\r\n        if parent does not exists in the tree then item is considered as root item\r\n      */\n      if (userItem.id != null) {\n        /* Organizational chart OrgItemConfig is almost the same as OrgItem \r\n          except options used to draw connectors in multi parent chart\r\n        */\n        orgItem = new OrgItem(userItem);\n\n        // OrgItem id coincides with OrgItemConfig id since we don't add any new org items to user's org chart definition\n        parsedId = parseInt(userItem.id, 10);\n        maximumId = Math.max(isNaN(parsedId) ? 0 : parsedId, maximumId);\n\n        // Collect org items\n        orgTree.add(userItem.parent, orgItem.id, orgItem);\n\n        /* We ignore looped items, it is applications responsibility to control data consistency */\n      }\n    }\n    /* create chart root item config */\n    maximumId += 1;\n    rootItemConfig = new OrgItemConfig();\n    rootItemConfig.id = maximumId;\n    rootItemConfig.title = \"internal root\";\n    rootItemConfig.isVisible = false;\n    rootItemConfig.isActive = false;\n\n    /* create chart org root item */\n    orgItemRoot = new OrgItem(rootItemConfig);\n    orgItemRoot.hideParentConnection = true;\n    orgItemRoot.hideChildrenConnection = true;\n    /* if user needs custom root item layout, it should explicitly create invisible node and set its children layout manually up */\n    orgItemRoot.childrenPlacementType = ChildrenPlacementType.Horizontal;\n    orgTree.add(null, orgItemRoot.id, orgItemRoot);\n    orgTree.loopLevels(this, function (nodeid, node, levelid) {\n      if (levelid > 0) {\n        return orgTree.BREAK;\n      }\n      if (orgItemRoot.id != nodeid) {\n        orgTree.adopt(orgItemRoot.id, nodeid);\n\n        /* root item must be regular */\n        node.itemType = ItemType.Regular;\n      }\n    });\n    hideRootConnectors(orgTree);\n    _data.orgTree = orgTree;\n    _data.maximumId = maximumId;\n    return true;\n  }\n  function hideRootConnectors(orgTree) {\n    orgTree.loopLevels(this, function (nodeid, node, levelid) {\n      var allRegular = true;\n      if (!node.isVisible) {\n        orgTree.loopChildren(this, nodeid, function (childid, child, index) {\n          if (child.itemType != ItemType.Regular) {\n            allRegular = false;\n            return true; // break\n          }\n        }); //ignore jslint\n\n        if (allRegular) {\n          node.hideChildrenConnection = true;\n          orgTree.loopChildren(this, nodeid, function (childid, child, index) {\n            child.hideParentConnection = true;\n          });\n        } else {\n          return orgTree.SKIP; // skip children\n        }\n      } else {\n        return orgTree.SKIP;\n      }\n    });\n  }\n  function getOrgTree() {\n    return _data.orgTree;\n  }\n  function getMaximumId() {\n    return _data.maximumId;\n  }\n  return {\n    process: process,\n    getOrgTree: getOrgTree,\n    getMaximumId: getMaximumId\n  };\n}\n;","map":{"version":3,"names":["Tree","OrgItem","OrgItemConfig","ItemType","ChildrenPlacementType","OrgTreeTask","itemsOptionTask","_data","orgTree","maximumId","process","createOrgTree","getItems","items","orgItem","orgItemRoot","userItem","index","len","parsedId","rootItemConfig","length","id","parseInt","Math","max","isNaN","add","parent","title","isVisible","isActive","hideParentConnection","hideChildrenConnection","childrenPlacementType","Horizontal","loopLevels","nodeid","node","levelid","BREAK","adopt","itemType","Regular","hideRootConnectors","allRegular","loopChildren","childid","child","SKIP","getOrgTree","getMaximumId"],"sources":["C:/Users/LCGI_15/Desktop/projects/nesty-orgchart/orgchart/node_modules/basicprimitives/src/tasks/transformations/OrgTreeTask.js"],"sourcesContent":["import Tree from '../../algorithms/Tree';\r\nimport OrgItem from '../../models/OrgItem';\r\nimport OrgItemConfig from '../../configs/OrgItemConfig';\r\nimport { ItemType, ChildrenPlacementType } from '../../enums';\r\n\r\nexport default function OrgTreeTask(itemsOptionTask) {\r\n  var _data = {\r\n    orgTree: null, /*Tree OrgItem */\r\n    maximumId: null /* maximum of OrgItem.id */\r\n  };\r\n\r\n  function process() {\r\n    createOrgTree(itemsOptionTask.getItems());\r\n\r\n    return true;\r\n  }\r\n\r\n  function createOrgTree(items) {\r\n    var orgItem,\r\n      orgItemRoot,\r\n      userItem,\r\n      index, len,\r\n      maximumId = 0,\r\n      parsedId,\r\n      // Organizational chart definition \r\n      orgTree = Tree(),\r\n      rootItemConfig;\r\n\r\n    /* convert items to hash table */\r\n    for (index = 0, len = items.length; index < len; index += 1) {\r\n      userItem = items[index];\r\n      /* user should define unique id for every OrgItemConfig otherwise we ignore it\r\n        if parent does not exists in the tree then item is considered as root item\r\n      */\r\n      if (userItem.id != null) {\r\n        /* Organizational chart OrgItemConfig is almost the same as OrgItem \r\n          except options used to draw connectors in multi parent chart\r\n        */\r\n        orgItem = new OrgItem(userItem);\r\n\r\n        // OrgItem id coincides with OrgItemConfig id since we don't add any new org items to user's org chart definition\r\n        parsedId = parseInt(userItem.id, 10);\r\n        maximumId = Math.max(isNaN(parsedId) ? 0 : parsedId, maximumId);\r\n\r\n        // Collect org items\r\n        orgTree.add(userItem.parent, orgItem.id, orgItem);\r\n\r\n        /* We ignore looped items, it is applications responsibility to control data consistency */\r\n      }\r\n    }\r\n    /* create chart root item config */\r\n    maximumId += 1;\r\n\r\n    rootItemConfig = new OrgItemConfig();\r\n    rootItemConfig.id = maximumId;\r\n    rootItemConfig.title = \"internal root\";\r\n    rootItemConfig.isVisible = false;\r\n    rootItemConfig.isActive = false;\r\n\r\n    /* create chart org root item */\r\n    orgItemRoot = new OrgItem(rootItemConfig);\r\n    orgItemRoot.hideParentConnection = true;\r\n    orgItemRoot.hideChildrenConnection = true;\r\n    /* if user needs custom root item layout, it should explicitly create invisible node and set its children layout manually up */\r\n    orgItemRoot.childrenPlacementType = ChildrenPlacementType.Horizontal; \r\n\r\n    orgTree.add(null, orgItemRoot.id, orgItemRoot);\r\n\r\n    orgTree.loopLevels(this, function (nodeid, node, levelid) {\r\n      if (levelid > 0) {\r\n        return orgTree.BREAK;\r\n      }\r\n      if (orgItemRoot.id != nodeid) {\r\n        orgTree.adopt(orgItemRoot.id, nodeid);\r\n\r\n        /* root item must be regular */\r\n        node.itemType = ItemType.Regular;\r\n      }\r\n    });\r\n\r\n    hideRootConnectors(orgTree);\r\n\r\n    _data.orgTree = orgTree;\r\n    _data.maximumId = maximumId;\r\n\r\n    return true;\r\n  }\r\n\r\n  function hideRootConnectors(orgTree) {\r\n    orgTree.loopLevels(this, function (nodeid, node, levelid) {\r\n      var allRegular = true;\r\n      if (!node.isVisible) {\r\n        orgTree.loopChildren(this, nodeid, function (childid, child, index) {\r\n          if (child.itemType != ItemType.Regular) {\r\n            allRegular = false;\r\n            return true; // break\r\n          }\r\n        }); //ignore jslint\r\n\r\n        if (allRegular) {\r\n          node.hideChildrenConnection = true;\r\n\r\n          orgTree.loopChildren(this, nodeid, function (childid, child, index) {\r\n            child.hideParentConnection = true;\r\n          });\r\n        } else {\r\n          return orgTree.SKIP; // skip children\r\n        }\r\n      } else {\r\n        return orgTree.SKIP;\r\n      }\r\n    });\r\n  }\r\n\r\n  function getOrgTree() {\r\n    return _data.orgTree;\r\n  }\r\n\r\n  function getMaximumId() {\r\n    return _data.maximumId;\r\n  }\r\n\r\n  return {\r\n    process: process,\r\n    getOrgTree: getOrgTree,\r\n    getMaximumId: getMaximumId\r\n  };\r\n};"],"mappings":"AAAA,OAAOA,IAAI,MAAM,uBAAuB;AACxC,OAAOC,OAAO,MAAM,sBAAsB;AAC1C,OAAOC,aAAa,MAAM,6BAA6B;AACvD,SAASC,QAAQ,EAAEC,qBAAqB,QAAQ,aAAa;AAE7D,eAAe,SAASC,WAAWA,CAACC,eAAe,EAAE;EACnD,IAAIC,KAAK,GAAG;IACVC,OAAO,EAAE,IAAI;IAAE;IACfC,SAAS,EAAE,IAAI,CAAC;EAClB,CAAC;EAED,SAASC,OAAOA,CAAA,EAAG;IACjBC,aAAa,CAACL,eAAe,CAACM,QAAQ,CAAC,CAAC,CAAC;IAEzC,OAAO,IAAI;EACb;EAEA,SAASD,aAAaA,CAACE,KAAK,EAAE;IAC5B,IAAIC,OAAO;MACTC,WAAW;MACXC,QAAQ;MACRC,KAAK;MAAEC,GAAG;MACVT,SAAS,GAAG,CAAC;MACbU,QAAQ;MACR;MACAX,OAAO,GAAGR,IAAI,CAAC,CAAC;MAChBoB,cAAc;;IAEhB;IACA,KAAKH,KAAK,GAAG,CAAC,EAAEC,GAAG,GAAGL,KAAK,CAACQ,MAAM,EAAEJ,KAAK,GAAGC,GAAG,EAAED,KAAK,IAAI,CAAC,EAAE;MAC3DD,QAAQ,GAAGH,KAAK,CAACI,KAAK,CAAC;MACvB;AACN;AACA;MACM,IAAID,QAAQ,CAACM,EAAE,IAAI,IAAI,EAAE;QACvB;AACR;AACA;QACQR,OAAO,GAAG,IAAIb,OAAO,CAACe,QAAQ,CAAC;;QAE/B;QACAG,QAAQ,GAAGI,QAAQ,CAACP,QAAQ,CAACM,EAAE,EAAE,EAAE,CAAC;QACpCb,SAAS,GAAGe,IAAI,CAACC,GAAG,CAACC,KAAK,CAACP,QAAQ,CAAC,GAAG,CAAC,GAAGA,QAAQ,EAAEV,SAAS,CAAC;;QAE/D;QACAD,OAAO,CAACmB,GAAG,CAACX,QAAQ,CAACY,MAAM,EAAEd,OAAO,CAACQ,EAAE,EAAER,OAAO,CAAC;;QAEjD;MACF;IACF;IACA;IACAL,SAAS,IAAI,CAAC;IAEdW,cAAc,GAAG,IAAIlB,aAAa,CAAC,CAAC;IACpCkB,cAAc,CAACE,EAAE,GAAGb,SAAS;IAC7BW,cAAc,CAACS,KAAK,GAAG,eAAe;IACtCT,cAAc,CAACU,SAAS,GAAG,KAAK;IAChCV,cAAc,CAACW,QAAQ,GAAG,KAAK;;IAE/B;IACAhB,WAAW,GAAG,IAAId,OAAO,CAACmB,cAAc,CAAC;IACzCL,WAAW,CAACiB,oBAAoB,GAAG,IAAI;IACvCjB,WAAW,CAACkB,sBAAsB,GAAG,IAAI;IACzC;IACAlB,WAAW,CAACmB,qBAAqB,GAAG9B,qBAAqB,CAAC+B,UAAU;IAEpE3B,OAAO,CAACmB,GAAG,CAAC,IAAI,EAAEZ,WAAW,CAACO,EAAE,EAAEP,WAAW,CAAC;IAE9CP,OAAO,CAAC4B,UAAU,CAAC,IAAI,EAAE,UAAUC,MAAM,EAAEC,IAAI,EAAEC,OAAO,EAAE;MACxD,IAAIA,OAAO,GAAG,CAAC,EAAE;QACf,OAAO/B,OAAO,CAACgC,KAAK;MACtB;MACA,IAAIzB,WAAW,CAACO,EAAE,IAAIe,MAAM,EAAE;QAC5B7B,OAAO,CAACiC,KAAK,CAAC1B,WAAW,CAACO,EAAE,EAAEe,MAAM,CAAC;;QAErC;QACAC,IAAI,CAACI,QAAQ,GAAGvC,QAAQ,CAACwC,OAAO;MAClC;IACF,CAAC,CAAC;IAEFC,kBAAkB,CAACpC,OAAO,CAAC;IAE3BD,KAAK,CAACC,OAAO,GAAGA,OAAO;IACvBD,KAAK,CAACE,SAAS,GAAGA,SAAS;IAE3B,OAAO,IAAI;EACb;EAEA,SAASmC,kBAAkBA,CAACpC,OAAO,EAAE;IACnCA,OAAO,CAAC4B,UAAU,CAAC,IAAI,EAAE,UAAUC,MAAM,EAAEC,IAAI,EAAEC,OAAO,EAAE;MACxD,IAAIM,UAAU,GAAG,IAAI;MACrB,IAAI,CAACP,IAAI,CAACR,SAAS,EAAE;QACnBtB,OAAO,CAACsC,YAAY,CAAC,IAAI,EAAET,MAAM,EAAE,UAAUU,OAAO,EAAEC,KAAK,EAAE/B,KAAK,EAAE;UAClE,IAAI+B,KAAK,CAACN,QAAQ,IAAIvC,QAAQ,CAACwC,OAAO,EAAE;YACtCE,UAAU,GAAG,KAAK;YAClB,OAAO,IAAI,CAAC,CAAC;UACf;QACF,CAAC,CAAC,CAAC,CAAC;;QAEJ,IAAIA,UAAU,EAAE;UACdP,IAAI,CAACL,sBAAsB,GAAG,IAAI;UAElCzB,OAAO,CAACsC,YAAY,CAAC,IAAI,EAAET,MAAM,EAAE,UAAUU,OAAO,EAAEC,KAAK,EAAE/B,KAAK,EAAE;YAClE+B,KAAK,CAAChB,oBAAoB,GAAG,IAAI;UACnC,CAAC,CAAC;QACJ,CAAC,MAAM;UACL,OAAOxB,OAAO,CAACyC,IAAI,CAAC,CAAC;QACvB;MACF,CAAC,MAAM;QACL,OAAOzC,OAAO,CAACyC,IAAI;MACrB;IACF,CAAC,CAAC;EACJ;EAEA,SAASC,UAAUA,CAAA,EAAG;IACpB,OAAO3C,KAAK,CAACC,OAAO;EACtB;EAEA,SAAS2C,YAAYA,CAAA,EAAG;IACtB,OAAO5C,KAAK,CAACE,SAAS;EACxB;EAEA,OAAO;IACLC,OAAO,EAAEA,OAAO;IAChBwC,UAAU,EAAEA,UAAU;IACtBC,YAAY,EAAEA;EAChB,CAAC;AACH;AAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}