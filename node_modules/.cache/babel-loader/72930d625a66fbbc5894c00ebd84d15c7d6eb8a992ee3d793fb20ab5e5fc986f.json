{"ast":null,"code":"import Family from '../../algorithms/Family';\nimport Tree from '../../algorithms/Tree';\nimport BranchAligner from './visualTreeBuilder/BranchAligner';\nimport VisualTreeBuilder from './visualTreeBuilder/VisualTreeBuilder';\nexport default function VisualTreeTask(orgTreeTask, activeItemsTask, visualTreeOptionTask) {\n  var _visualTree,\n    /* Tree(); key: TreeItem.id value: TreeItem */\n    _leftMargins,\n    _rightMargins,\n    _navigationFamily,\n    /* Family structure where key: TreeItem.id and value: TreeItem */\n    _treeItemCounter,\n    _branchAligner,\n    _visualTreeBuilder = VisualTreeBuilder();\n  function process() {\n    var orgTree = orgTreeTask.getOrgTree();\n    var options = visualTreeOptionTask.getOptions();\n    var activeItems = activeItemsTask != null ? activeItemsTask.getActiveItems() : {};\n    _treeItemCounter = orgTreeTask.getMaximumId();\n    if (orgTree.hasNodes()) {\n      ({\n        visualTree: _visualTree,\n        navigationFamily: _navigationFamily,\n        treeItemCounter: _treeItemCounter,\n        branchAligner: _branchAligner\n      } = _visualTreeBuilder.build(orgTree, _treeItemCounter, activeItems, options));\n    } else {\n      _visualTree = Tree();\n      _navigationFamily = Family();\n      _branchAligner = BranchAligner();\n    }\n    ({\n      leftMargins: _leftMargins,\n      rightMargins: _rightMargins\n    } = getVisualTreeMargins(_visualTree));\n    return true;\n  }\n  function getVisualTreeMargins(visualTree) {\n    var leftMargins = {};\n    var rightMargins = {};\n    visualTree.loop(this, function (nodeid, node) {\n      leftMargins[nodeid] = [];\n      rightMargins[nodeid] = [];\n    });\n    visualTree.loopPostOrder(this, function (nodeid, node, parentid, parent) {\n      var parentLeftMargins = leftMargins[parentid],\n        parentRightMargins = rightMargins[parentid],\n        nodeLeftMargins = leftMargins[nodeid],\n        nodeRightMargins = rightMargins[nodeid],\n        index,\n        len;\n      if (parentid != null) {\n        /* update parent left margins */\n        if (!parentLeftMargins[0]) {\n          parentLeftMargins[0] = nodeid;\n        }\n        for (index = 0, len = nodeLeftMargins.length; index < len; index += 1) {\n          if (!parentLeftMargins[index + 1]) {\n            parentLeftMargins[index + 1] = nodeLeftMargins[index];\n          }\n        }\n\n        /* update parent rights margins */\n        parentRightMargins[0] = nodeid;\n        for (index = 0, len = nodeRightMargins.length; index < len; index += 1) {\n          parentRightMargins[index + 1] = nodeRightMargins[index];\n        }\n      }\n    });\n    return {\n      leftMargins: leftMargins,\n      rightMargins: rightMargins\n    };\n  }\n  function getVisualTree() {\n    return _visualTree;\n  }\n  function getLogicalFamily() {\n    return _navigationFamily;\n  }\n  function getBranchAligner() {\n    return _branchAligner;\n  }\n  function getLeftMargins() {\n    return _leftMargins;\n  }\n  function getRightMargins() {\n    return _rightMargins;\n  }\n  function getMaximumId() {\n    return _treeItemCounter;\n  }\n  return {\n    process: process,\n    getVisualTree: getVisualTree,\n    getLogicalFamily: getLogicalFamily,\n    getLeftMargins: getLeftMargins,\n    getRightMargins: getRightMargins,\n    getMaximumId: getMaximumId,\n    getBranchAligner: getBranchAligner\n  };\n}\n;","map":{"version":3,"names":["Family","Tree","BranchAligner","VisualTreeBuilder","VisualTreeTask","orgTreeTask","activeItemsTask","visualTreeOptionTask","_visualTree","_leftMargins","_rightMargins","_navigationFamily","_treeItemCounter","_branchAligner","_visualTreeBuilder","process","orgTree","getOrgTree","options","getOptions","activeItems","getActiveItems","getMaximumId","hasNodes","visualTree","navigationFamily","treeItemCounter","branchAligner","build","leftMargins","rightMargins","getVisualTreeMargins","loop","nodeid","node","loopPostOrder","parentid","parent","parentLeftMargins","parentRightMargins","nodeLeftMargins","nodeRightMargins","index","len","length","getVisualTree","getLogicalFamily","getBranchAligner","getLeftMargins","getRightMargins"],"sources":["C:/Users/LCGI_15/Desktop/projects/nesty-orgchart/orgchart/node_modules/basicprimitives/src/tasks/transformations/VisualTreeTask.js"],"sourcesContent":["import Family from '../../algorithms/Family';\r\nimport Tree from '../../algorithms/Tree';\r\nimport BranchAligner from './visualTreeBuilder/BranchAligner';\r\nimport VisualTreeBuilder from './visualTreeBuilder/VisualTreeBuilder';\r\n\r\nexport default function VisualTreeTask(orgTreeTask, activeItemsTask, visualTreeOptionTask) {\r\n  var _visualTree, /* Tree(); key: TreeItem.id value: TreeItem */\r\n    _leftMargins,\r\n    _rightMargins,\r\n    _navigationFamily, /* Family structure where key: TreeItem.id and value: TreeItem */\r\n    _treeItemCounter,\r\n    _branchAligner,\r\n    _visualTreeBuilder = VisualTreeBuilder();\r\n\r\n  function process() {\r\n    var orgTree = orgTreeTask.getOrgTree();\r\n    var options = visualTreeOptionTask.getOptions();\r\n    var activeItems = activeItemsTask != null ? activeItemsTask.getActiveItems() : {};\r\n\r\n    _treeItemCounter = orgTreeTask.getMaximumId();\r\n\r\n    if (orgTree.hasNodes()) {\r\n      ({ \r\n        visualTree: _visualTree, \r\n        navigationFamily: _navigationFamily,\r\n        treeItemCounter: _treeItemCounter,\r\n        branchAligner: _branchAligner\r\n      } = _visualTreeBuilder.build(orgTree, _treeItemCounter, activeItems, options));\r\n    } else {\r\n      _visualTree = Tree();\r\n      _navigationFamily = Family();\r\n      _branchAligner = BranchAligner();\r\n    }\r\n\r\n    ({\r\n      leftMargins: _leftMargins,\r\n      rightMargins: _rightMargins\r\n    } = getVisualTreeMargins(_visualTree));\r\n\r\n    return true;\r\n  }\r\n\r\n  function getVisualTreeMargins(visualTree) {\r\n    var leftMargins = {}\r\n    var rightMargins = {};\r\n    visualTree.loop(this, function (nodeid, node) {\r\n      leftMargins[nodeid] = [];\r\n      rightMargins[nodeid] = [];\r\n    });\r\n\r\n    visualTree.loopPostOrder(this, function (nodeid, node, parentid, parent) {\r\n      var parentLeftMargins = leftMargins[parentid],\r\n        parentRightMargins = rightMargins[parentid],\r\n        nodeLeftMargins = leftMargins[nodeid],\r\n        nodeRightMargins = rightMargins[nodeid],\r\n        index, len;\r\n\r\n      if (parentid != null) {\r\n        /* update parent left margins */\r\n        if (!parentLeftMargins[0]) {\r\n          parentLeftMargins[0] = nodeid;\r\n        }\r\n\r\n        for (index = 0, len = nodeLeftMargins.length; index < len; index += 1) {\r\n          if (!parentLeftMargins[index + 1]) {\r\n            parentLeftMargins[index + 1] = nodeLeftMargins[index];\r\n          }\r\n        }\r\n\r\n        /* update parent rights margins */\r\n        parentRightMargins[0] = nodeid;\r\n\r\n        for (index = 0, len = nodeRightMargins.length; index < len; index += 1) {\r\n          parentRightMargins[index + 1] = nodeRightMargins[index];\r\n        }\r\n      }\r\n    });\r\n\r\n    return {\r\n      leftMargins: leftMargins,\r\n      rightMargins: rightMargins\r\n    }\r\n  }\r\n\r\n  function getVisualTree() {\r\n    return _visualTree;\r\n  }\r\n\r\n  function getLogicalFamily() {\r\n    return _navigationFamily;\r\n  }\r\n\r\n  function getBranchAligner() {\r\n    return _branchAligner;\r\n  }\r\n\r\n  function getLeftMargins() {\r\n    return _leftMargins;\r\n  }\r\n\r\n  function getRightMargins() {\r\n    return _rightMargins;\r\n  }\r\n\r\n  function getMaximumId() {\r\n    return _treeItemCounter;\r\n  }\r\n\r\n  return {\r\n    process: process,\r\n    getVisualTree: getVisualTree,\r\n    getLogicalFamily: getLogicalFamily,\r\n    getLeftMargins: getLeftMargins,\r\n    getRightMargins: getRightMargins,\r\n    getMaximumId: getMaximumId,\r\n    getBranchAligner: getBranchAligner\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}