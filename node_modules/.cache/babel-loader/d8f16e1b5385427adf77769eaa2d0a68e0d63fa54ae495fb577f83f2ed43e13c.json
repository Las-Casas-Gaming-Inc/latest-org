{"ast":null,"code":"import { isNullOrEmpty } from '../common';\nexport default function ArrayReader(itemTemplate, containsUniqueItems, uniquePropertyKey, createSourceHash, isOrdered) {\n  this.itemTemplate = itemTemplate;\n  this.containsUniqueItems = containsUniqueItems;\n  this.uniquePropertyKey = uniquePropertyKey;\n  this.containsPrimitiveValues = isNullOrEmpty(uniquePropertyKey);\n  this.createSourceHash = createSourceHash;\n  this.isOrdered = isOrdered;\n}\n;\nArrayReader.prototype.read = function (target, source, path, context) {\n  var result = [],\n    resultHash = {},\n    hash,\n    sequence,\n    resultSequence = {},\n    sourceHash = {},\n    item,\n    itemid,\n    index,\n    len,\n    newHashObject,\n    sequencePath = path + \"-seq\";\n\n  /* validate source array */\n  if (!source || !Array.isArray(source)) {\n    source = [];\n  }\n\n  /* hash values for tracking changes */\n  hash = context.hash.hasOwnProperty(path) ? context.hash[path] : {};\n  sequence = context.hash.hasOwnProperty(sequencePath) ? context.hash[sequencePath] : {};\n  for (index = 0, len = source.length; index < len; index += 1) {\n    item = source[index];\n    itemid = this.containsUniqueItems ? this.containsPrimitiveValues ? item : item[this.uniquePropertyKey] : index;\n    if (!resultHash.hasOwnProperty(itemid)) {\n      newHashObject = this.itemTemplate.read(hash.hasOwnProperty(itemid) ? hash[itemid] : {}, item, path + \"-\" + index, context);\n      result.push(newHashObject);\n      resultHash[itemid] = newHashObject;\n      resultSequence[index] = itemid;\n      if (this.createSourceHash) {\n        sourceHash[itemid] = item;\n      }\n      if (this.isOrdered) {\n        if (sequence[index] != resultSequence[index]) {\n          context.isChanged = true;\n        }\n      }\n    }\n  }\n  context.hash[path] = resultHash;\n  context.hash[sequencePath] = resultSequence;\n  if (this.createSourceHash) {\n    context.sourceHash[path] = sourceHash;\n  }\n  if (target == null || target.length != result.length) {\n    context.isChanged = true;\n  }\n  return result;\n};","map":{"version":3,"names":["isNullOrEmpty","ArrayReader","itemTemplate","containsUniqueItems","uniquePropertyKey","createSourceHash","isOrdered","containsPrimitiveValues","prototype","read","target","source","path","context","result","resultHash","hash","sequence","resultSequence","sourceHash","item","itemid","index","len","newHashObject","sequencePath","Array","isArray","hasOwnProperty","length","push","isChanged"],"sources":["/Users/iamnestyyy/ReactProjects/orgchart/node_modules/basicprimitives/src/readers/ArrayReader.js"],"sourcesContent":["import {isNullOrEmpty} from '../common';\r\n\r\nexport default function ArrayReader(itemTemplate, containsUniqueItems, uniquePropertyKey, createSourceHash, isOrdered) {\r\n  this.itemTemplate = itemTemplate;\r\n  this.containsUniqueItems = containsUniqueItems;\r\n  this.uniquePropertyKey = uniquePropertyKey;\r\n  this.containsPrimitiveValues = isNullOrEmpty(uniquePropertyKey);\r\n  this.createSourceHash = createSourceHash;\r\n  this.isOrdered = isOrdered;\r\n};\r\n\r\nArrayReader.prototype.read = function (target, source, path, context) {\r\n  var result = [], resultHash = {},\r\n    hash, sequence, resultSequence = {},\r\n    sourceHash = {},\r\n    item, itemid,\r\n    index, len,\r\n    newHashObject,\r\n    sequencePath = path + \"-seq\";\r\n\r\n  /* validate source array */\r\n  if (!source || !Array.isArray(source)) {\r\n    source = [];\r\n  }\r\n\r\n  /* hash values for tracking changes */\r\n  hash = context.hash.hasOwnProperty(path) ? context.hash[path] : {};\r\n  sequence = context.hash.hasOwnProperty(sequencePath) ? context.hash[sequencePath] : {};\r\n\r\n  for (index = 0, len = source.length; index < len; index += 1) {\r\n    item = source[index];\r\n\r\n    itemid = this.containsUniqueItems ? (this.containsPrimitiveValues ? item : item[this.uniquePropertyKey]) : index;\r\n\r\n    if (!resultHash.hasOwnProperty(itemid)) {\r\n      newHashObject = this.itemTemplate.read(hash.hasOwnProperty(itemid) ? hash[itemid] : {}, item, path + \"-\" + index, context);\r\n\r\n      result.push(newHashObject);\r\n      resultHash[itemid] = newHashObject;\r\n      resultSequence[index] = itemid;\r\n      if (this.createSourceHash) {\r\n        sourceHash[itemid] = item;\r\n      }\r\n\r\n      if (this.isOrdered) {\r\n        if (sequence[index] != resultSequence[index]) {\r\n          context.isChanged = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  context.hash[path] = resultHash;\r\n  context.hash[sequencePath] = resultSequence;\r\n  if (this.createSourceHash) {\r\n    context.sourceHash[path] = sourceHash;\r\n  }\r\n\r\n  if (target == null || target.length != result.length) {\r\n    context.isChanged = true;\r\n  }\r\n\r\n  return result;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}