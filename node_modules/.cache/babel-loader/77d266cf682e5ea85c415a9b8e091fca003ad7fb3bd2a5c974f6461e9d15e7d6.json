{"ast":null,"code":"/*  1. Topologically sort _logicalFamily items and assign levels.\r\n    2. Optimize references. Transform M:N relations to M:1:N where it is possible.\r\n    3. Eliminate Many to Many relations. Logical family consists of 1:M and M:1 relations only.\r\n    4. Resort items, so original visible items stay at the same level.\r\n    5. Fill in missed items between levels. So that way we have invisible items between parent/child family items if they have gap between levels.\r\n      Such invisible family items have isVisible option set to false.\r\n*/\n\nimport FamilyNormalizer from './familyTransformations/FamilyNormalizer';\nexport default function NormalizeLogicalFamilyTask(normalizeOptionTask, extractNestedLayoutsTask) {\n  var _data = {\n      maximumId: null,\n      /* maximum of OrgItem.id */\n      logicalFamily: null\n    },\n    _familyNormalizer = new FamilyNormalizer(false);\n  function process(debug) {\n    var logicalFamily = extractNestedLayoutsTask.getLogicalFamily(),\n      maximumId = extractNestedLayoutsTask.getMaximumId(),\n      normalizeOptions = normalizeOptionTask.getOptions();\n    var options = {\n      groupByType: normalizeOptions.groupByType,\n      alignBylevels: normalizeOptions.alignBylevels\n    };\n    logicalFamily = logicalFamily.clone();\n    maximumId = _familyNormalizer.normalize(options, logicalFamily, maximumId);\n    _data.logicalFamily = logicalFamily;\n    _data.maximumId = maximumId;\n    return true;\n  }\n  function getLogicalFamily() {\n    return _data.logicalFamily;\n  }\n  function getMaximumId() {\n    return _data.maximumId;\n  }\n  return {\n    process: process,\n    getLogicalFamily: getLogicalFamily,\n    getMaximumId: getMaximumId\n  };\n}\n;","map":{"version":3,"names":["FamilyNormalizer","NormalizeLogicalFamilyTask","normalizeOptionTask","extractNestedLayoutsTask","_data","maximumId","logicalFamily","_familyNormalizer","process","debug","getLogicalFamily","getMaximumId","normalizeOptions","getOptions","options","groupByType","alignBylevels","clone","normalize"],"sources":["/Users/iamnestyyy/ReactProjects/orgchart/node_modules/basicprimitives/src/tasks/transformations/NormalizeLogicalFamilyTask.js"],"sourcesContent":["/*  1. Topologically sort _logicalFamily items and assign levels.\r\n    2. Optimize references. Transform M:N relations to M:1:N where it is possible.\r\n    3. Eliminate Many to Many relations. Logical family consists of 1:M and M:1 relations only.\r\n    4. Resort items, so original visible items stay at the same level.\r\n    5. Fill in missed items between levels. So that way we have invisible items between parent/child family items if they have gap between levels.\r\n      Such invisible family items have isVisible option set to false.\r\n*/\r\n\r\nimport FamilyNormalizer from './familyTransformations/FamilyNormalizer';\r\n\r\nexport default function NormalizeLogicalFamilyTask(normalizeOptionTask, extractNestedLayoutsTask) {\r\n  var _data = {\r\n    maximumId: null, /* maximum of OrgItem.id */\r\n    logicalFamily: null\r\n  },\r\n    _familyNormalizer = new FamilyNormalizer(false);\r\n\r\n  function process(debug) {\r\n    var logicalFamily = extractNestedLayoutsTask.getLogicalFamily(),\r\n      maximumId = extractNestedLayoutsTask.getMaximumId(),\r\n      normalizeOptions = normalizeOptionTask.getOptions();\r\n\r\n    var options = {\r\n      groupByType: normalizeOptions.groupByType,\r\n      alignBylevels: normalizeOptions.alignBylevels\r\n    };\r\n    logicalFamily = logicalFamily.clone();\r\n    maximumId = _familyNormalizer.normalize(options, logicalFamily, maximumId);\r\n\r\n    _data.logicalFamily = logicalFamily;\r\n    _data.maximumId = maximumId;\r\n\r\n    return true;\r\n  }\r\n\r\n  function getLogicalFamily() {\r\n    return _data.logicalFamily;\r\n  }\r\n\r\n  function getMaximumId() {\r\n    return _data.maximumId;\r\n  }\r\n\r\n  return {\r\n    process: process,\r\n    getLogicalFamily: getLogicalFamily,\r\n    getMaximumId: getMaximumId\r\n  };\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,gBAAgB,MAAM,0CAA0C;AAEvE,eAAe,SAASC,0BAA0BA,CAACC,mBAAmB,EAAEC,wBAAwB,EAAE;EAChG,IAAIC,KAAK,GAAG;MACVC,SAAS,EAAE,IAAI;MAAE;MACjBC,aAAa,EAAE;IACjB,CAAC;IACCC,iBAAiB,GAAG,IAAIP,gBAAgB,CAAC,KAAK,CAAC;EAEjD,SAASQ,OAAOA,CAACC,KAAK,EAAE;IACtB,IAAIH,aAAa,GAAGH,wBAAwB,CAACO,gBAAgB,CAAC,CAAC;MAC7DL,SAAS,GAAGF,wBAAwB,CAACQ,YAAY,CAAC,CAAC;MACnDC,gBAAgB,GAAGV,mBAAmB,CAACW,UAAU,CAAC,CAAC;IAErD,IAAIC,OAAO,GAAG;MACZC,WAAW,EAAEH,gBAAgB,CAACG,WAAW;MACzCC,aAAa,EAAEJ,gBAAgB,CAACI;IAClC,CAAC;IACDV,aAAa,GAAGA,aAAa,CAACW,KAAK,CAAC,CAAC;IACrCZ,SAAS,GAAGE,iBAAiB,CAACW,SAAS,CAACJ,OAAO,EAAER,aAAa,EAAED,SAAS,CAAC;IAE1ED,KAAK,CAACE,aAAa,GAAGA,aAAa;IACnCF,KAAK,CAACC,SAAS,GAAGA,SAAS;IAE3B,OAAO,IAAI;EACb;EAEA,SAASK,gBAAgBA,CAAA,EAAG;IAC1B,OAAON,KAAK,CAACE,aAAa;EAC5B;EAEA,SAASK,YAAYA,CAAA,EAAG;IACtB,OAAOP,KAAK,CAACC,SAAS;EACxB;EAEA,OAAO;IACLG,OAAO,EAAEA,OAAO;IAChBE,gBAAgB,EAAEA,gBAAgB;IAClCC,YAAY,EAAEA;EAChB,CAAC;AACH;AAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}