{"ast":null,"code":"import ArrayReader from '../../../readers/ArrayReader';\nimport ValueReader from '../../../readers/ValueReader';\nimport { PageFitMode, Visibility } from '../../../enums';\nexport default function FamNormalVisibilityItemsByMinimumVisibleLevelsTask(minimumVisibleLevelsOptionTask, orderFamilyNodesTask) {\n  var _data = {\n      items: []\n    },\n    _hash = {};\n  var _dataTemplate = new ArrayReader(new ValueReader([\"string\", \"number\"], true), true);\n  function process() {\n    var context = {\n        isChanged: false,\n        hash: _hash\n      },\n      treeLevels = orderFamilyNodesTask.getTreeLevels(),\n      {\n        pageFitMode,\n        minimalVisibility,\n        minimumVisibleLevels\n      } = minimumVisibleLevelsOptionTask.getOptions();\n    _data.items = _dataTemplate.read(_data.items, getSelectedItems(treeLevels, pageFitMode, minimalVisibility, minimumVisibleLevels), \"items\", context);\n    return context.isChanged;\n  }\n  function getSelectedItems(treeLevels, pageFitMode, minimalVisibility, minimumVisibleLevels) {\n    var result = [];\n    if (minimumVisibleLevels > 0) {\n      if (PageFitMode.PageWidth == pageFitMode || PageFitMode.PageHeight || PageFitMode.FitToPage) {\n        if (minimalVisibility != Visibility.Normal) {\n          var index = 0,\n            currentLevel = null;\n          treeLevels.loopLevels(this, function (levelIndex, level) {\n            treeLevels.loopLevelItems(this, levelIndex, function (nodeId, node, position) {\n              if (node.isVisible) {\n                if (currentLevel !== levelIndex) {\n                  currentLevel = levelIndex;\n                  index += 1;\n                }\n                result.push(nodeId);\n              }\n            });\n            if (index >= minimumVisibleLevels) {\n              return true;\n            }\n          });\n        }\n      }\n    }\n    return result;\n  }\n  function getItems() {\n    return _data.items;\n  }\n  return {\n    process: process,\n    getItems: getItems\n  };\n}\n;","map":{"version":3,"names":["ArrayReader","ValueReader","PageFitMode","Visibility","FamNormalVisibilityItemsByMinimumVisibleLevelsTask","minimumVisibleLevelsOptionTask","orderFamilyNodesTask","_data","items","_hash","_dataTemplate","process","context","isChanged","hash","treeLevels","getTreeLevels","pageFitMode","minimalVisibility","minimumVisibleLevels","getOptions","read","getSelectedItems","result","PageWidth","PageHeight","FitToPage","Normal","index","currentLevel","loopLevels","levelIndex","level","loopLevelItems","nodeId","node","position","isVisible","push","getItems"],"sources":["C:/Users/LCGI_15/Desktop/projects/nesty-orgchart/orgchart/node_modules/basicprimitives/src/tasks/transformations/selection/FamNormalVisibilityItemsByMinimumVisibleLevelsTask.js"],"sourcesContent":["import ArrayReader from '../../../readers/ArrayReader';\r\nimport ValueReader from '../../../readers/ValueReader';\r\nimport { PageFitMode, Visibility } from '../../../enums';\r\n\r\nexport default function FamNormalVisibilityItemsByMinimumVisibleLevelsTask(minimumVisibleLevelsOptionTask, orderFamilyNodesTask) {\r\n  var _data = {\r\n    items: []\r\n  },\r\n    _hash = {};\r\n\r\n  var _dataTemplate = new ArrayReader(\r\n    new ValueReader([\"string\", \"number\"], true),\r\n    true\r\n  );\r\n\r\n  function process() {\r\n    var context = {\r\n      isChanged: false,\r\n      hash: _hash\r\n    },\r\n    treeLevels = orderFamilyNodesTask.getTreeLevels(),\r\n    { pageFitMode, minimalVisibility, minimumVisibleLevels } = minimumVisibleLevelsOptionTask.getOptions();\r\n\r\n    _data.items = _dataTemplate.read(_data.items, getSelectedItems(treeLevels, pageFitMode, minimalVisibility, minimumVisibleLevels), \"items\", context);\r\n\r\n    return context.isChanged;\r\n  }\r\n\r\n  function getSelectedItems(treeLevels, pageFitMode, minimalVisibility, minimumVisibleLevels ) {\r\n    var result = [];\r\n\r\n    if(minimumVisibleLevels > 0) {\r\n      if(PageFitMode.PageWidth == pageFitMode || PageFitMode.PageHeight || PageFitMode.FitToPage) {\r\n        if(minimalVisibility != Visibility.Normal) {\r\n          var index = 0,\r\n            currentLevel = null;\r\n          treeLevels.loopLevels(this, function(levelIndex, level) {\r\n            treeLevels.loopLevelItems(this, levelIndex, function(nodeId, node, position) {\r\n              if(node.isVisible) {\r\n                if(currentLevel !== levelIndex) {\r\n                  currentLevel = levelIndex;\r\n                  index+=1;\r\n                }\r\n                result.push(nodeId);\r\n              }\r\n            })\r\n            if(index >= minimumVisibleLevels) {\r\n              return true;\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  function getItems() {\r\n    return _data.items;\r\n  }\r\n\r\n  return {\r\n    process: process,\r\n    getItems: getItems\r\n  };\r\n};"],"mappings":"AAAA,OAAOA,WAAW,MAAM,8BAA8B;AACtD,OAAOC,WAAW,MAAM,8BAA8B;AACtD,SAASC,WAAW,EAAEC,UAAU,QAAQ,gBAAgB;AAExD,eAAe,SAASC,kDAAkDA,CAACC,8BAA8B,EAAEC,oBAAoB,EAAE;EAC/H,IAAIC,KAAK,GAAG;MACVC,KAAK,EAAE;IACT,CAAC;IACCC,KAAK,GAAG,CAAC,CAAC;EAEZ,IAAIC,aAAa,GAAG,IAAIV,WAAW,CACjC,IAAIC,WAAW,CAAC,CAAC,QAAQ,EAAE,QAAQ,CAAC,EAAE,IAAI,CAAC,EAC3C,IACF,CAAC;EAED,SAASU,OAAOA,CAAA,EAAG;IACjB,IAAIC,OAAO,GAAG;QACZC,SAAS,EAAE,KAAK;QAChBC,IAAI,EAAEL;MACR,CAAC;MACDM,UAAU,GAAGT,oBAAoB,CAACU,aAAa,CAAC,CAAC;MACjD;QAAEC,WAAW;QAAEC,iBAAiB;QAAEC;MAAqB,CAAC,GAAGd,8BAA8B,CAACe,UAAU,CAAC,CAAC;IAEtGb,KAAK,CAACC,KAAK,GAAGE,aAAa,CAACW,IAAI,CAACd,KAAK,CAACC,KAAK,EAAEc,gBAAgB,CAACP,UAAU,EAAEE,WAAW,EAAEC,iBAAiB,EAAEC,oBAAoB,CAAC,EAAE,OAAO,EAAEP,OAAO,CAAC;IAEnJ,OAAOA,OAAO,CAACC,SAAS;EAC1B;EAEA,SAASS,gBAAgBA,CAACP,UAAU,EAAEE,WAAW,EAAEC,iBAAiB,EAAEC,oBAAoB,EAAG;IAC3F,IAAII,MAAM,GAAG,EAAE;IAEf,IAAGJ,oBAAoB,GAAG,CAAC,EAAE;MAC3B,IAAGjB,WAAW,CAACsB,SAAS,IAAIP,WAAW,IAAIf,WAAW,CAACuB,UAAU,IAAIvB,WAAW,CAACwB,SAAS,EAAE;QAC1F,IAAGR,iBAAiB,IAAIf,UAAU,CAACwB,MAAM,EAAE;UACzC,IAAIC,KAAK,GAAG,CAAC;YACXC,YAAY,GAAG,IAAI;UACrBd,UAAU,CAACe,UAAU,CAAC,IAAI,EAAE,UAASC,UAAU,EAAEC,KAAK,EAAE;YACtDjB,UAAU,CAACkB,cAAc,CAAC,IAAI,EAAEF,UAAU,EAAE,UAASG,MAAM,EAAEC,IAAI,EAAEC,QAAQ,EAAE;cAC3E,IAAGD,IAAI,CAACE,SAAS,EAAE;gBACjB,IAAGR,YAAY,KAAKE,UAAU,EAAE;kBAC9BF,YAAY,GAAGE,UAAU;kBACzBH,KAAK,IAAE,CAAC;gBACV;gBACAL,MAAM,CAACe,IAAI,CAACJ,MAAM,CAAC;cACrB;YACF,CAAC,CAAC;YACF,IAAGN,KAAK,IAAIT,oBAAoB,EAAE;cAChC,OAAO,IAAI;YACb;UACF,CAAC,CAAC;QACJ;MACF;IACF;IAEA,OAAOI,MAAM;EACf;EAEA,SAASgB,QAAQA,CAAA,EAAG;IAClB,OAAOhC,KAAK,CAACC,KAAK;EACpB;EAEA,OAAO;IACLG,OAAO,EAAEA,OAAO;IAChB4B,QAAQ,EAAEA;EACZ,CAAC;AACH;AAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}