{"ast":null,"code":"import { Layers } from '../../enums';\nimport MergedRectangles from '../../graphics/shapes/MergedRectangles';\nimport BackgroundAnnotationConfig from '../../configs/BackgroundAnnotationConfig';\nimport Rect from '../../graphics/structs/Rect';\nexport default function DrawBackgroundAnnotationTask(getGraphics, createTransformTask, applyLayoutChangesTask, backgroundAnnotationOptionTask, navigationFamilyTask, alignDiagramTask) {\n  var _graphics, _positions, _transform;\n  function process() {\n    var annotations = backgroundAnnotationOptionTask.getAnnotations(),\n      navigationFamily;\n    _graphics = getGraphics();\n    _graphics.reset(\"placeholder\", Layers.BackgroundAnnotation);\n    if (annotations.length > 0) {\n      _positions = alignDiagramTask.getItemsPositions();\n      _transform = createTransformTask.getTransform();\n      navigationFamily = navigationFamilyTask.getLogicalFamily();\n      drawAnnotations(annotations, _positions, navigationFamily);\n    }\n    return false;\n  }\n  function drawAnnotations(annotations, positions, navigationFamily) {\n    var panel, index, len, index2, len2, index3, len3, shape, defaultConfig, rects, rect, itemsHash, item, properties, property, annotationConfig, treeItemPosition;\n    for (index = 0, len = annotations.length; index < len; index += 1) {\n      annotationConfig = annotations[index];\n      if (annotationConfig.items != null && annotationConfig.items.length > 0) {\n        shape = new MergedRectangles(_graphics);\n        shape.transform = _transform;\n        defaultConfig = new BackgroundAnnotationConfig();\n        properties = [\"opacity\", \"lineWidth\", \"borderColor\", \"fillColor\", \"lineType\"];\n        for (index3 = 0, len3 = properties.length; index3 < len3; index3 += 1) {\n          property = properties[index3];\n          shape[property] = annotationConfig.hasOwnProperty(property) ? annotationConfig[property] : defaultConfig[property];\n        }\n        panel = _graphics.activate(\"placeholder\", Layers.BackgroundAnnotation);\n        rects = [];\n        itemsHash = {};\n        for (index2 = 0, len2 = annotationConfig.items.length; index2 < len2; index2 += 1) {\n          item = annotationConfig.items[index2];\n          treeItemPosition = alignDiagramTask.getItemPosition(item);\n          if (treeItemPosition != null) {\n            itemsHash[item] = true;\n            rect = new Rect(treeItemPosition.actualPosition);\n            rect.offset(annotationConfig.offset);\n            rects.push(rect);\n            if (annotationConfig.includeChildren) {\n              navigationFamily.loopChildren(this, item, function (childItemId, childItem) {\n                if (!itemsHash[childItemId]) {\n                  itemsHash[childItemId] = true;\n                  treeItemPosition = alignDiagramTask.getItemPosition(childItemId);\n                  if (treeItemPosition != null) {\n                    rect = new Rect(treeItemPosition.actualPosition);\n                    rect.offset(annotationConfig.offset);\n                    rects.push(rect);\n                  }\n                }\n              }); //ignore jslint\n            }\n          }\n        }\n        shape.draw(rects);\n      }\n    }\n  }\n  return {\n    process: process\n  };\n}\n;","map":{"version":3,"names":["Layers","MergedRectangles","BackgroundAnnotationConfig","Rect","DrawBackgroundAnnotationTask","getGraphics","createTransformTask","applyLayoutChangesTask","backgroundAnnotationOptionTask","navigationFamilyTask","alignDiagramTask","_graphics","_positions","_transform","process","annotations","getAnnotations","navigationFamily","reset","BackgroundAnnotation","length","getItemsPositions","getTransform","getLogicalFamily","drawAnnotations","positions","panel","index","len","index2","len2","index3","len3","shape","defaultConfig","rects","rect","itemsHash","item","properties","property","annotationConfig","treeItemPosition","items","transform","hasOwnProperty","activate","getItemPosition","actualPosition","offset","push","includeChildren","loopChildren","childItemId","childItem","draw"],"sources":["/Users/iamnestyyy/ReactProjects/orgchart/node_modules/basicprimitives/src/tasks/renders/DrawBackgroundAnnotationTask.js"],"sourcesContent":["import { Layers } from '../../enums';\r\nimport MergedRectangles from '../../graphics/shapes/MergedRectangles';\r\nimport BackgroundAnnotationConfig from '../../configs/BackgroundAnnotationConfig';\r\nimport Rect from '../../graphics/structs/Rect';\r\n\r\nexport default function DrawBackgroundAnnotationTask(getGraphics, createTransformTask, applyLayoutChangesTask,\r\n  backgroundAnnotationOptionTask, navigationFamilyTask, alignDiagramTask) {\r\n  var _graphics,\r\n    _positions,\r\n    _transform;\r\n\r\n  function process() {\r\n    var annotations = backgroundAnnotationOptionTask.getAnnotations(),\r\n      navigationFamily;\r\n\r\n    _graphics = getGraphics();\r\n    _graphics.reset(\"placeholder\", Layers.BackgroundAnnotation);\r\n\r\n    if (annotations.length > 0) {\r\n      _positions = alignDiagramTask.getItemsPositions();\r\n      _transform = createTransformTask.getTransform();\r\n\r\n      navigationFamily = navigationFamilyTask.getLogicalFamily();\r\n\r\n      drawAnnotations(annotations, _positions, navigationFamily);\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function drawAnnotations(annotations, positions, navigationFamily) {\r\n    var panel,\r\n      index, len,\r\n      index2, len2,\r\n      index3, len3,\r\n      shape,\r\n      defaultConfig,\r\n      rects, rect,\r\n      itemsHash, item,\r\n      properties, property,\r\n      annotationConfig, treeItemPosition;\r\n\r\n    for (index = 0, len = annotations.length; index < len; index += 1) {\r\n      annotationConfig = annotations[index];\r\n\r\n      if (annotationConfig.items != null && annotationConfig.items.length > 0) {\r\n        shape = new MergedRectangles(_graphics);\r\n        shape.transform = _transform;\r\n        defaultConfig = new BackgroundAnnotationConfig();\r\n        properties = [\"opacity\", \"lineWidth\", \"borderColor\", \"fillColor\", \"lineType\"];\r\n        for (index3 = 0, len3 = properties.length; index3 < len3; index3 += 1) {\r\n          property = properties[index3];\r\n          shape[property] = annotationConfig.hasOwnProperty(property) ? annotationConfig[property] : defaultConfig[property];\r\n        }\r\n        panel = _graphics.activate(\"placeholder\", Layers.BackgroundAnnotation);\r\n\r\n        rects = [];\r\n        itemsHash = {};\r\n        for (index2 = 0, len2 = annotationConfig.items.length; index2 < len2; index2 += 1) {\r\n          item = annotationConfig.items[index2];\r\n          treeItemPosition = alignDiagramTask.getItemPosition(item);\r\n          if (treeItemPosition != null) {\r\n            itemsHash[item] = true;\r\n            rect = new Rect(treeItemPosition.actualPosition);\r\n            rect.offset(annotationConfig.offset);\r\n            rects.push(rect);\r\n\r\n            if (annotationConfig.includeChildren) {\r\n              navigationFamily.loopChildren(this, item, function (childItemId, childItem) {\r\n                if (!itemsHash[childItemId]) {\r\n                  itemsHash[childItemId] = true;\r\n                  treeItemPosition = alignDiagramTask.getItemPosition(childItemId);\r\n                  if (treeItemPosition != null) {\r\n                    rect = new Rect(treeItemPosition.actualPosition);\r\n                    rect.offset(annotationConfig.offset);\r\n                    rects.push(rect);\r\n                  }\r\n                }\r\n              }); //ignore jslint\r\n            }\r\n          }\r\n        }\r\n        shape.draw(rects);\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    process: process\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}