{"ast":null,"code":"import Family from '../algorithms/Family';\nimport DependencyManager from './DependencyManager';\nimport { splitCamelCaseName } from '../common';\nexport default function TaskManager() {\n  var _taskFamily = new Family();\n  var _dependencies = new DependencyManager();\n  var _tasks = [];\n  function TaskInfo(name, dependencies, factory, color) {\n    this.name = name;\n    this.dependencies = dependencies;\n    this.factory = factory;\n    this.task = null;\n    this.color = color;\n  }\n  function addTask(taskName, taskDependencies, factory, color) {\n    if (_tasks.length > 0) {\n      throw \"Task Manager is already initialized\";\n    }\n    _taskFamily.add(taskDependencies, taskName, new TaskInfo(taskName, taskDependencies, factory, color));\n  }\n  function getTask(taskName) {\n    var taskInfo = _taskFamily.node(taskName);\n    return taskInfo && taskInfo.task;\n  }\n  function addDependency(name, dependency) {\n    if (_tasks.length > 0) {\n      throw \"Task Manager is already initialized\";\n    }\n    _dependencies.register(name, dependency);\n  }\n  function process(startTask, stopTask, debug) {\n    var hasChanges = false,\n      logtime = debug;\n    if (_tasks.length === 0) {\n      _taskFamily.loopTopo(this, function (taskName, taskInfo) {\n        taskInfo.task = _dependencies.register(taskName, _dependencies.resolve(taskInfo.dependencies, taskInfo.factory)());\n        _tasks.push(taskInfo);\n      });\n    }\n    if (debug) {\n      // eslint-disable-next-line no-console\n      console.log(\"-- process --\");\n    }\n    var isRequired = {};\n    for (var index = 0, len = _tasks.length; index < len; index += 1) {\n      var taskInfo = _tasks[index],\n        dependents = [];\n      if (taskInfo.name == startTask || isRequired.hasOwnProperty(taskInfo.name)) {\n        if (logtime) {\n          var startAt = performance.now(); //ignore jslint\n        }\n        if (hasChanges = taskInfo.task.process(debug)) {\n          _taskFamily.loopChildren(this, taskInfo.name, function (childTaskName, childTaskInfo) {\n            isRequired[childTaskName] = true;\n            if (debug) {\n              dependents.push(childTaskName);\n            }\n            return _taskFamily.SKIP;\n          });\n        }\n        if (logtime) {\n          var endAt = performance.now(); //ignore jslint\n        }\n        if (debug) {\n          var spentTime = Math.round(endAt - startAt, 2);\n          // eslint-disable-next-line no-console\n          console.log(index + \". \" + taskInfo.name + (\", \" + spentTime + \" ms. \") + (hasChanges ? \" - forces: \" + dependents.toString() : \"\"));\n        }\n      }\n      if (taskInfo.name == stopTask) {\n        return;\n      }\n    }\n  }\n  function getProcessDiagramConfig() {\n    var result = [];\n    if (_tasks.length === 0) {\n      _taskFamily.loopTopo(this, function (taskName, taskInfo) {\n        taskInfo.task = _dependencies.register(taskName, _dependencies.resolve(taskInfo.dependencies, taskInfo.factory)());\n        _tasks.push(taskInfo);\n      });\n    }\n    for (var index = 0, len = _tasks.length; index < len; index += 1) {\n      var taskInfo = _tasks[index];\n      var itemConfig = {\n        id: taskInfo.name,\n        title: splitCamelCaseName(taskInfo.name).join(\" \"),\n        description: taskInfo.task.description || \"\",\n        itemTitleColor: taskInfo.color,\n        parents: []\n      };\n      _taskFamily.loopParents(this, taskInfo.name, function (parentTaskName, parentTaskInfo) {\n        itemConfig.parents.push(parentTaskName);\n        return _taskFamily.SKIP;\n      });\n      result.push(itemConfig);\n    }\n    return result;\n  }\n  return {\n    addTask: addTask,\n    addDependency: addDependency,\n    getTask: getTask,\n    process: process,\n    getProcessDiagramConfig: getProcessDiagramConfig\n  };\n}\n;","map":{"version":3,"names":["Family","DependencyManager","splitCamelCaseName","TaskManager","_taskFamily","_dependencies","_tasks","TaskInfo","name","dependencies","factory","color","task","addTask","taskName","taskDependencies","length","add","getTask","taskInfo","node","addDependency","dependency","register","process","startTask","stopTask","debug","hasChanges","logtime","loopTopo","resolve","push","console","log","isRequired","index","len","dependents","hasOwnProperty","startAt","performance","now","loopChildren","childTaskName","childTaskInfo","SKIP","endAt","spentTime","Math","round","toString","getProcessDiagramConfig","result","itemConfig","id","title","join","description","itemTitleColor","parents","loopParents","parentTaskName","parentTaskInfo"],"sources":["C:/Users/LCGI_15/Desktop/projects/nesty-orgchart/orgchart/node_modules/basicprimitives/src/managers/TaskManager.js"],"sourcesContent":["import Family from '../algorithms/Family';\r\nimport DependencyManager from './DependencyManager';\r\nimport { splitCamelCaseName } from '../common';\r\n\r\nexport default function TaskManager() {\r\n  var _taskFamily = new Family();\r\n  var _dependencies = new DependencyManager();\r\n  var _tasks = [];\r\n\r\n  function TaskInfo(name, dependencies, factory, color) {\r\n    this.name = name;\r\n    this.dependencies = dependencies;\r\n    this.factory = factory;\r\n    this.task = null;\r\n    this.color = color;\r\n  }\r\n\r\n  function addTask(taskName, taskDependencies, factory, color) {\r\n    if (_tasks.length > 0) {\r\n      throw \"Task Manager is already initialized\";\r\n    }\r\n    _taskFamily.add(taskDependencies, taskName, new TaskInfo(taskName, taskDependencies, factory, color));\r\n  }\r\n\r\n  function getTask(taskName) {\r\n    var taskInfo = _taskFamily.node(taskName);\r\n    return taskInfo && taskInfo.task;\r\n  }\r\n\r\n  function addDependency(name, dependency) {\r\n    if (_tasks.length > 0) {\r\n      throw \"Task Manager is already initialized\";\r\n    }\r\n    _dependencies.register(name, dependency);\r\n  }\r\n\r\n  function process(startTask, stopTask, debug) {\r\n    var hasChanges = false,\r\n      logtime = debug;\r\n    if (_tasks.length === 0) {\r\n      _taskFamily.loopTopo(this, function (taskName, taskInfo) {\r\n        taskInfo.task = _dependencies.register(taskName, _dependencies.resolve(taskInfo.dependencies, taskInfo.factory)());\r\n        _tasks.push(taskInfo);\r\n      });\r\n    }\r\n    if (debug) {\r\n      // eslint-disable-next-line no-console\r\n      console.log(\"-- process --\");\r\n    }\r\n    var isRequired = {};\r\n    for (var index = 0, len = _tasks.length; index < len; index += 1) {\r\n      var taskInfo = _tasks[index],\r\n        dependents = [];\r\n\r\n      if (taskInfo.name == startTask || isRequired.hasOwnProperty(taskInfo.name)) {\r\n        if (logtime) {\r\n          var startAt = performance.now(); //ignore jslint\r\n        }\r\n        if ((hasChanges = taskInfo.task.process(debug))) {\r\n          _taskFamily.loopChildren(this, taskInfo.name, function (childTaskName, childTaskInfo) {\r\n            isRequired[childTaskName] = true;\r\n            if (debug) {\r\n              dependents.push(childTaskName);\r\n            }\r\n            return _taskFamily.SKIP;\r\n          });\r\n        }\r\n        if (logtime) {\r\n          var endAt = performance.now(); //ignore jslint\r\n        }\r\n        if (debug) {\r\n          var spentTime = Math.round((endAt - startAt), 2);\r\n          // eslint-disable-next-line no-console\r\n          console.log(index + \". \" + taskInfo.name + (\", \" + spentTime + \" ms. \") + (hasChanges ? \" - forces: \" + dependents.toString() : \"\"));\r\n        }\r\n      }\r\n      if (taskInfo.name == stopTask) {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  function getProcessDiagramConfig() {\r\n    var result = [];\r\n    if (_tasks.length === 0) {\r\n      _taskFamily.loopTopo(this, function (taskName, taskInfo) {\r\n        taskInfo.task = _dependencies.register(taskName, _dependencies.resolve(taskInfo.dependencies, taskInfo.factory)());\r\n        _tasks.push(taskInfo);\r\n      });\r\n    }\r\n    for (var index = 0, len = _tasks.length; index < len; index += 1) {\r\n      var taskInfo = _tasks[index];\r\n\r\n      var itemConfig = {\r\n        id: taskInfo.name,\r\n        title: splitCamelCaseName(taskInfo.name).join(\" \"),\r\n        description: taskInfo.task.description || \"\",\r\n        itemTitleColor: taskInfo.color,\r\n        parents: []\r\n      }\r\n      _taskFamily.loopParents(this, taskInfo.name, function (parentTaskName, parentTaskInfo) {\r\n        itemConfig.parents.push(parentTaskName);\r\n        return _taskFamily.SKIP;\r\n      });\r\n      result.push(itemConfig);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  return {\r\n    addTask: addTask,\r\n    addDependency: addDependency,\r\n    getTask: getTask,\r\n    process: process,\r\n    getProcessDiagramConfig: getProcessDiagramConfig\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}